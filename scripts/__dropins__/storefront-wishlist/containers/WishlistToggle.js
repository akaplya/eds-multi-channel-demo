/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as s}from"@dropins/tools/preact-jsx-runtime.js";import{useState as o,useEffect as w}from"@dropins/tools/preact-compat.js";import{Button as v,Icon as d}from"@dropins/tools/components.js";import{events as a}from"@dropins/tools/event-bus.js";import{s as y,g as S,r as C}from"../chunks/removeProductsFromWishlist.js";import{c as P,a as x}from"../chunks/initializeWishlist.js";import{S as A,a as D}from"../chunks/HeartFilled.js";import"@dropins/tools/fetch-graphql.js";import"@dropins/tools/lib.js";const G=({product:i})=>{const[m,u]=o(y.authenticated),[n,e]=o(!1),[h,l]=o(null),{isGuestWishlistEnabled:f}=P.getConfig();w(()=>{const p=t=>u(t),k=t=>{t.action==="add"&&t.item.product.sku===i.sku&&(l(t.item),e(!0))},W=()=>{var c;const t=S(),r=(c=t==null?void 0:t.items)==null?void 0:c.find(I=>I.product.sku===i.sku);l(r||null),e(!!r)};a.on("authenticated",p),a.on("wishlist/update",k),a.on("wishlist/data",W)},[i.sku]);const g=async()=>{n?(await C([h]),e(!1)):await x([{sku:i.sku,quantity:1}])};return!m&&!f?null:s(v,{"data-testid":"wishlist-toggle",size:"medium",variant:"tertiary",icon:n?s("span",{"data-testid":"icon-filled",children:s(d,{source:A})}):s("span",{"data-testid":"icon-empty",children:s(d,{source:D})}),onClick:g})};export{G as WishlistToggle,G as default};
